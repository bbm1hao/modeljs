<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Modeljs Unit Tests</title>
    <link rel="stylesheet" href="../lib/qunit-1.9.0.css" />
    <script src="../lib/qunit-1.9.0.js"></script>
    <script src="../src/model.js"></script>
    <script src="../test/ModelTests.js"></script>
    <script>
    // browser only tests
    QUnit.module("browser Specific");

    test("NoConflict", function () {
        expect(3);
        ok (Model, "Model exists in global namespace prior to noConflict");
        var originalModel = Model;
        var myModel = Model.noConflict();

        ok (!Model, "Model remove from global namespace after noConflict called");
        equal(myModel, originalModel, "Model returned from noConflict Method");
        window.Model = myModel; //restore the world so other tests continue to work
    });

    test("JSONP Remote Model", function () {
        expect(2);
        stop();
        var test = new Model();
        // fyi this jsonp request is local (ie. not Cross-orgin), but it's good enough to test.
        test.createProperty ("remoteModel", {prop1: "defaultValue"}, {
            // $jsonpCallback will be replaced by real generated function callback name by modeljs
            url: "modeljsJSONPtest.js?jsonpCallbackParameter=$jsonpCallback",
            doNotPersist: true,
            refreshRate: -1, // -1 means fetch once.
            isJSONPurl: true,
            validator: function() {
                return true;
            }
        });

        test.remoteModel.onChange(function (property, oldValue) {
            ok(test.remoteModel.jsonPRequestSuccessful, "remoteModel was modified to have a jsonPRequestSuccessful property");
            start();
        });

        ok(!test.remoteModel.jsonPRequestSuccessful, "remoteModel count property DNE");
    });


    </script>
</head>
<body>
    <div id="qunit"></div>
    <div id="qunit-fixture">

    </div>
</body>
</html>